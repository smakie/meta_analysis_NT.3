---
title: "meta_analysis_NT"
output: html_document
date: '2022-03-05'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages}
library(metafor)
library(tidyverse)
library(kableExtra)
library(openxlsx)
```

## R Markdown

```{r things_I_dont_know}
#if(!"tinytex" %in% rownames(installed.packages())) install.packages("tinytex")
#tinytex::install_tinytex()
#if(!"devtools" %in% rownames(installed.packages())) install.packages("devtools")
#devtools::install_github("crsh/papaja")
```

```{r effect_size_conversion}
#Converts from Student's t to Pearson's r
t_to_r <- function(t, n, k){sqrt(
  (t^2)/((t^2)+(n-1-k))
  )}

t_to_r(t = 2.34, n = 251, k = 4)


######################################################################
#Cohen's f-squared to r (Cohen, 1988; checked)
f2_to_r <- function(f2){
  sqrt(
    (f2)/(1+f2)
  )
}


######################################################################
#r to Fisher's z
#Fisher's z of r can be calculated using one of the following functions
#Equation 1:
r_to_fz <- function(r){
  (log((1+r)/(1-r)))/2
  }
#Equation 2:
atanh(0.439941345)
#Proving that both functions are the same 
r_to_fz (0.439941345) - atanh(0.439941345)


######################################################################
#variance of Fisher's z (checked)
var_fz <- function(n){1/(n-3)}
sqrt(var_fz(50))


######################################################################
#Standard error of Fisher's z (checked)
se_fz <- function(n)(sqrt(1/(n-3)))


######################################################################
#Confidence Interval for Fisher's z 
ci_fz <- function(fz, se_fz, cl){
  lower <- fz-(((qnorm(p = ((1-((1-cl)/2))), mean = 0, sd = 1)))*(se_fz))
  upper <- fz+(((qnorm(p = ((1-((1-cl)/2))), mean = 0, sd = 1)))*(se_fz))
  return(c(lower, upper))}


######################################################################
#Hybrid function that returns Fisher's z, variance of Fisher's z, Standard Error of Fisher's z, and confidence intervals 
r_to_fz.2 <- function(r, n, cl){
  r <- r
  n <- n
  fz <- (log((1+r)/(1-r)))/2
  var_fz <- (1/(n-3))
  se_fz <- sqrt(1/(n-3))
  lower_ci <- fz-(((qnorm(p = ((1-(1-cl)/2)), mean = 0, sd = 1)))*(se_fz))
  upper_ci <- fz+(((qnorm(p = ((1-(1-cl)/2)), mean = 0, sd = 1)))*(se_fz))
  return(data.frame(r, n, fz, var_fz, se_fz, lower_ci, upper_ci))
}
#Example 
r_to_fz.2(r = 0.778, n = 78, cl = .95)


######################################################################
#A function that convert Pearson's r to Fisher's z 
#Returns the effect size, variance, standard error, and confidence intervals for both Pearson's r and Fisher's z
rzr <- function(data, cl){
  data %>% mutate(fz = (log((1+r)/(1-r)))/2) %>% 
    mutate(fz.2 = atanh(r)) %>% 
    mutate(var_fz = 1/(n-3)) %>% 
    mutate(se_fz = sqrt(1/(n-3))) %>% 
    mutate(weight = 1/var_fz) %>% 
    mutate(CI_lower_fz = fz-(((qnorm(p = ((1-((1-cl)/2))), mean = 0, sd = 1)))*(se_fz))) %>% 
    mutate(CI_upper_fz = fz+(((qnorm(p = ((1-((1-cl)/2))), mean = 0, sd = 1)))*(se_fz))) %>% 
    mutate(var_r = (exp(2*var_fz)-1)/(exp(2*var_fz)+1)) %>% 
    mutate(se_r = (exp(2*se_fz)-1)/(exp(2*se_fz)+1)) %>% 
    mutate(CI_lower_r = (exp(2*CI_lower_fz)-1)/(exp(2*CI_lower_fz)+1)) %>% 
    mutate(CI_upper_r = (exp(2*CI_upper_fz)-1)/(exp(2*CI_upper_fz)+1))
}
######################################################################
#Fisher's z to r
#Function 1
fz_to_r <- function(fz){
  (exp(2*fz)-1)/(exp(2*fz)+1)
}

#Proving that both functions are the same 
fz_to_r(0.56) - tanh(0.56)


######################################################################
#Partial correlation 
pr <- function(r_ac, r_bc, r_ab.c){
  r_ab <- (r_ab.c*(sqrt((1-(r_ac^2))*(1-(r_bc^2)))))+(r_ac*r_bc)
  return(c(r_ab))}
pr(r_ab.c = 0.343110576, r_ac = 0.493963561, r_bc = 0.42)

######################################################################
time_converter <- function(min, d, m, y){
      mins <- ifelse(
    missing(min),
    ifelse(
      missing(d),
      ifelse(
        missing(m),
        y*525960,
        m*44560.5),
      d*1440),
    min*1)
    days <- ifelse(
    missing(d),
    ifelse(
      missing(min),
      ifelse(
        missing(m),
        y*365.25,
        m*30.4375),
      min/1440),
    d*1)
  months <- ifelse(
    missing(m),
    ifelse(
      missing(min), 
      ifelse(
        missing(d), 
        y*12, 
        d/30.4375),
      min/43830),
    m*1)
  years <- ifelse(
    missing(y),
    ifelse(
      missing(min), 
      ifelse(
        missing(d), 
        m/12, 
        d/365.25),
      min/525960),
    y*1)
  return(tibble(mins,days, months, years))
}

time_converter(y = 1)
```



```{r son_and_hur.2020}
son_and_hur.2020_tib <- c(
  "son_and_hur.2020a", 
  "son_and_hur.2020b") %>% data.frame() %>% rename(., effect = .) %>% add_column(
    effect_description = c("Total Math Talk - Fall MA", "Total Maths Talk - Spring MA"),
    year = c(2020, 2020),
    country = c("US", "US"),
    study_id = c("i", "i"),
    design = c("Correlational", "Correlational"),
    design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational"), 
    SES = c("Low", "Low"),
    main_language = c("English", "English"),
    deliverer_type = c("Parent", "Parent"),
    mothers = c(1, 1),
    white = c(0.500, 0.500), 
    female = c(0.47826087, 0.47826087),
    child_age_study_start = c(1717.284, 1717.284),
    child_age_NT_start = c(NA, NA),
    child_age_NT_mid = c(1793.378, 1793.378),
    child_age_NT_end = c(NA, NA),
    child_age_MA = c(1793.378, 2067.315),
    NT_measure_time = c(17.5, 17.5),
    time_between_NT_mid_MA = c(0, 273.937),
    intervention_dosage = c(NA, NA),
    NT_context = c("Home", "Home"),
    MA_context = c("School", "School"),
    NT_size = c(NA, NA),
    NT_size.1 = c("Overall", "Overall"),
    NT_size.2 = c("Overall", "Overall"),
    NT_type = c("Overall", "Overall"),
    NT_type.1 = c("Overall", "Overall"),
    NT_type.2 = c("Overall", "Overall"), 
    NT_type.3 = c("Overall", "Overall"),
    NT_type.4 = c("Overall", "Overall"),
    NT_type.5 = c("Overall", "Overall"),
    NT_type.6 = c("Overall", "Overall"),
    NT_type.7 = c("Overall", "Overall"),
    NT_type.8 = c("Overall", "Overall"),
    NT_type.9 = c("Overall", "Overall"),
    NT_type.10 = c("Overall", "Overall"),
    MA_test = c("WJ_AP", "WJ_AP"),
    MA_measure = c("Overall", "Overall"),
    analysis = c("Zero_Order_Correlation", "Zero_Order_Correlation"),
    controlled_variables = c(0, 0),
    r = c(0.22, 0.21),
    n = c(29, 29))
son_and_hur.2020_tib 
```


```{r ramani_et_al.2015}
ramani_et_al.2015_tib <- c(
  "ramani_et_al.2015a", 
  "ramani_et_al.2015b", 
  "ramani_et_al.2015c", 
  "ramani_et_al.2015d",
  "ramani_et_al.2015e",
  "ramani_et_al.2015f",
  "ramani_et_al.2015g",
  "ramani_et_al.2015h",
  "ramani_et_al.2015i",
  "ramani_et_al.2015j",
  "ramani_et_al.2015k",
  "ramani_et_al.2015l") %>% data.frame() %>% rename(., effect = .) %>% add_column(
    effect_description = c("Counting and Number Identification - Verbal Counting", "Cardinality and Ordering  - Verbal Counting", "Counting and Number Identification - Number Identification", "Cardinality and Ordering - Number Identification", "Counting and Number Identification - Counting principles", "Cardinality and Ordering - Counting principles", "Counting and Number Identification - Enumeration and Cardinality", "Cardinality and Ordering - Enumeration and Cardinality", "Counting and Number Identification - Number Line Estimation", "Cardinality and Ordering - Number Line Estimation", "Counting and Number Identification - Magnitude Comparison", "Cardinality and Ordering - Magnitude Comparison"),
    year = c(2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015, 2015),
    country = c("US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US", "US"),
    study_id = c("c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c", "c"),
    design = c("Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational"),
    design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational"), 
    SES = c("Low", "Low", "Low", "Low", "Low", "Low", "Low", "Low", "Low", "Low", "Low", "Low"),
    main_language = c("English", "English", "English", "English", "English", "English", "English", "English", "English", "English", "English", "English"),
    deliverer_type = c("Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver", "Caregiver"),
    mothers = c(0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788, 0.787878788),
    white = c(0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33, 0.33), 
    female = c(0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6),
    child_age_study_start = c(1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75),
    child_age_NT_start = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
    child_age_NT_mid = c(1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75, 1582.75),
    child_age_NT_end = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
    child_age_MA = c(1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25, 1593.25),
    NT_measure_time = c(15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15),
    time_between_NT_mid_MA = c(10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5, 10.5),
    intervention_dosage = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
    NT_context = c("School", "School", "School", "School", "School", "School", "School", "School", "School", "School", "School", "School"),
    MA_context = c("School", "School", "School", "School", "School", "School", "School", "School", "School", "School", "School", "School"),
    NT_size = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
    NT_size.1 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
    NT_size.2 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
    NT_type = c("Counting_and_Number_Identificaton", "Cardinality_and_Ordering", "Counting_and_Number_Identification", "Cardinality_and_Ordering", "Counting_and_Number_Identification", "Cardinality_and_Ordering", "Counting_and_Number_Identification", "Cardinality_and_Ordering", "Counting_and_Number_Identification", "Cardinality_and_Ordering", "Counting_and_Number_Identification", "Cardinality_and_Ordering"),
    NT_type.1 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
    NT_type.2 = c("Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality"),
    NT_type.3 = c("Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering"),
    NT_type.4 = c("Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering", "Number_Identification", "Ordering"),
    NT_type.5 = c("Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering"),
    NT_type.6 = c("Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering", "Counting", "Ordering"),
    NT_type.7 = c("Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality"),
    NT_type.8 = c("Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality", "Counting", "Cardinality"),
    NT_type.9 = c("Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality", "Number_Identification", "Cardinality"),
    NT_type.10 = c(NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA),
    MA_test = c("Verbal_Counting", "Verbal_Counting", "Number_Identification", "Number_Identification", "Counting_Principles", "Counting_Principles", "Enumeration_and_Cardinality", "Enumeration_and_Cardinality", "Number_Line_Estimation", "Number_Line_Estimation", "Magnitude_Comparison", "Magnitude_Comparison"),
    MA_measure = c("Counting", "Counting", "Number_Identification", "Number_Identification", "Counting", "Counting", "Cardinality", "Cardinality", "Number_Line_Estimation", "Number_Line_Estimation", "Magnitude_Comparison", "Magnitude_Comparison"),
    analysis = c("Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order _orrelation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation"),
    controlled_variables = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
    r = c(-0.12, 0.11, -0.19, 0.10, 0.07, 0.17, -0.31, -0.03, 0.05, 0.37, 0.11, 0.39),
    n = c(33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33))
#ramani_et_al.2015_kable <- ramani_et_al.2015_tib %>% 
  #dplyr::mutate(dplyr::across(where(is.numeric), ~round(., 2))) %>% 
  #kable(format = "html", caption = "Ramani et al. (2015) effect sizes and associated inferential statistics", col.names = c("Effect id", "Effect Description", "Analysis", "Controlled variables","r", "n", "z", "Var of z", "SE of z", "Weight", "Lower CI for z", "Upper CI for z", "Var of r", "SE of r", "Lower CI for r", "Upper CI for r")) %>% kable_styling(full_width = T, position = "center") %>% row_spec(row = 0, extra_css = "border-bottom: 2px solid black;") #
ramani_et_al.2015_tib
```

```{r mutaf_yildiz et al.2018}
mutaf_yildiz_et_al.2018_tib <- c(
  "mutaf_yildiz_et_al.2018a", 
  "mutaf_yildiz_et_al.2018b"
  ) %>% data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("NT during book reading - Calculation skill", "NT during Lego playing - Calculation skill"),
      year = c(2018, 2018),
      country = c("BE", "BE"),
      study_id = c("g", "g"),
      design = c("Correlational", "Correlational"),
      design.2 = c("Cross_sectional_Correlational", "Cross_sectional_Correlational"), 
      SES = c("Middle", "Middle"),
      main_language = c("Dutch", "Dutch"),
      deliverer_type = c("Parent", "Parent"),
      mothers = c(0.682, 0.682),
      white = c(NA, NA), 
      female = c(0.454545455, 0.454545455),
      child_age_study_start = c(2060.01, 2060.01),
      child_age_NT_start = c(NA, NA),
      child_age_NT_mid = c(2060.01, 2060.01),
      child_age_NT_end = c(NA, NA),
      child_age_MA = c(2060.01, 2060.01),
      NT_measure_time = c(5, 5),
      time_between_NT_mid_MA = c(0, 0),
      intervention_dosage = c(NA, NA),
      NT_context = c("Home", "Home"),
      MA_context = c("Home", "Home"),
      NT_size = c(NA, NA),
      NT_size.1 = c("Overall", "Overall"),
      NT_size.2 = c("Overall", "Overall"),
      NT_type = c("Overall", "Overall"),
      NT_type.1 = c("Overall", "Overall"),
      NT_type.2 = c("Overall", "Overall"), 
      NT_type.3 = c("Overall", "Overall"),
      NT_type.4 = c("Overall", "Overall"),
      NT_type.5 = c("Overall", "Overall"),
      NT_type.6 = c("Overall", "Overall"),
      NT_type.7 = c("Overall", "Overall"),
      NT_type.8 = c("Overall", "Overall"),
      NT_type.9 = c("Overall", "Overall"),
      NT_type.10 = c("Overall", "Overall"),
      MA_test = c("TediMath", "TediMath"),
      MA_measure = c("Calculation", "Calculation"),
      analysis = c("Zero_Order_Correlation", "Zero_Order_Correlation"),
      controlled_variables = c(0, 0),
      r = c(-0.05, -0.35),
      n = c(44, 44)) 
mutaf_yildiz_et_al.2018_tib
```

```{r elliott_et_al.2017}
elliott_et_al.2017_tib <- c(
  "elliott_et_al.2017a") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("NT - TEMA-3"),
      year = c(2017),
      country = c("US"),
      study_id = c("e"),
      design = c("Correlational"),
      design.2 = c("Cross_sectional_Correlational"), 
      SES = c("Middle"),
      main_language = c("English"),
      deliverer_type = c("Parent"),
      mothers = c(1),
      white = c(0.89), 
      female = c(0.434782609),
      child_age_study_start = c(2116.928),
      child_age_NT_start = c(NA),
      child_age_NT_mid = c(2116.928),
      child_age_NT_end = c(NA),
      child_age_MA = c(2116.928),
      NT_measure_time = c(10),
      time_between_NT_mid_MA= c(0),
      intervention_dosage = c(NA),
      NT_context = c("Lab"),
      MA_context = c("Lab"),
      NT_size = c("Overall"),
      NT_size.1 = c("Overall"),
      NT_size.2 = c("Overall"),
      NT_type = c("Overall"),
      NT_type.1 = c("Overall"),
      NT_type.2 = c("Overall"),
      NT_type.3 = c("Overall"),
      NT_type.4 = c("Overall"),
      NT_type.5 = c("Overall"),
      NT_type.6 = c("Overall"),
      NT_type.7 = c("Overall"),
      NT_type.8 = c("Overall"),
      NT_type.9 = c("Overall"),
      NT_type.10 = c("Overall"),
      MA_test = c("TEMA_3"),
      MA_measure = c("Overall"),
      analysis = c("Zero_Order_Correlation"),
      controlled_variables = c(0),
      r = c(0.16),
      n = c(44))
elliott_et_al.2017_tib
```

```{r levine_et_al.2010}
levine_et_al.2010_tib <- c(
  "levine_et_al.2010a") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("NT - Point-to-X"),
      year = c(2010),
      country = c("US"),
      study_id = c("a"),
      design = c("Correlational"),
      design.2 = c("Longitudinal_Correlational"), 
      SES = c("Middle"),
      main_language = c("English"),
      deliverer_type = c("Caregiver"),
      mothers = c(NA),
      white = c(0.704545455), 
      female = c(0.454545455),
      child_age_study_start = c(426.125),
      child_age_NT_start = c(426.125),
      child_age_NT_mid = c(669.625),
      child_age_NT_end = c(913.125),
      child_age_MA = c(1400.125),
      NT_measure_time = c(450),
      time_between_NT_mid_MA = c(730.5),
      intervention_dosage = c(NA),
      NT_context = c("Home"),
      MA_context = c(NA),
      NT_size = c("Overall"),
      NT_size.1 = c("Overall"),
      NT_size.2 = c("Overall"),
      NT_type = c("Overall"),
      NT_type.1 = c("Overall"),
      NT_type.2 = c("Overall"),
      NT_type.3 = c("Overall"),
      NT_type.4 = c("Overall"),
      NT_type.5 = c("Overall"),
      NT_type.6 = c("Overall"),
      NT_type.7 = c("Overall"),
      NT_type.8 = c("Overall"),
      NT_type.9 = c("Overall"),
      NT_type.10 = c("Overall"),
      MA_test = c("Point_to_X"),
      MA_measure = c("Cardinality"),
      analysis = c("Zero Order Correlation"),
      controlled_variables = c(0),
      r = c(0.47),
      n = c(44))
levine_et_al.2010_tib
#CHECKS: 2
```

```{r gunderson_and_levine.2011}
#Uncontrolling SES 
#Effect e: NT with present objects, small set predicting Point-to-X (Uncontrolled for SES)
pr(r_ab.c = 0.343110576, r_ac = 0.493963561, r_bc = 0.42)
#Effect f: NT without present objects, small set predicting Point-to-X (Uncontrolled for SES)
pr(r_ab.c = 0.188982236, r_ac = 0.493963561, r_bc = 0.40)
#Effect g: NT with present objects, large set predicting Point-to-X (Uncontrolled for SES)
pr(r_ab.c = 0.455710387, r_ac = 0.493963561, r_bc = 0.23)
#Effect h: NT without present objects, large set predicting Point-to-X (Uncontrolled for SES)
pr(r_ab.c = 0.178174161, r_ac = 0.493963561, r_bc = 0.06)

(0.4782052 + 0.3481842)/2
(0.4992211 + 0.184278)/2

gunderson_and_levine.2011_tib <- c(
  "gunderson_and_levine.2011a", 
  "gunderson_and_levine.2011b") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Small NT predicting Point-to-X", "Large NT predicting Point-to-X"),
      year = c(2010, 2010),
      country = c("US", "US"),
      study_id = c("a", "a"),
      design = c("Correlational", "Correlational"),
      design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational"), 
      SES = c("Middle", "Middle"),
      main_language = c("English", "English"),
      deliverer_type = c("Caregiver", "Caregiver"),
      mothers = c(NA, NA),
      white = c(0.704545455, 0.704545455), 
      female = c(0.454545455, 0.454545455),
      child_age_study_start = c(426.125, 426.125),
      child_age_NT_start = c(426.125, 426.125),
      child_age_NT_mid = c(669.625, 669.625),
      child_age_NT_end = c(913.125, 913.125),
      child_age_MA = c(1400.125, 1400.125),
      NT_measure_time = c(450, 450),
      time_between_NT_mid_MA = c(730.5, 730.5),
      intervention_dosage = c(NA, NA),
      NT_context = c("Home", "Home"),
      MA_context = c(NA, NA),
      NT_size = c("Small", "Large"),
      NT_size.1 = c("Small", "Medium"),
      NT_size.2 = c("Small", "Medium"),
      NT_type = c("Overall", "Overall"),
      NT_type.1 = c("Overall", "Overall"),
      NT_type.2 = c("Overall", "Overall"),
      NT_type.3 = c("Overall", "Overall"),
      NT_type.4 = c("Overall", "Overall"),
      NT_type.5 = c("Overall", "Overall"),
      NT_type.6 = c("Overall", "Overall"),
      NT_type.7 = c("Overall", "Overall"),
      NT_type.8 = c("Overall", "Overall"),
      NT_type.9 = c("Overall", "Overall"),
      NT_type.10 = c("Overall", "Overall"),
      MA_test = c("Point_to_X", "Point_to_X"),
      MA_measure = c("Cardinality", "Cardinality"),
      analysis = c("Calculated_manually", "Calculated_manually"),
      controlled_variables = c(0, 0),
      r = c(0.4131947, 0.3417495),
      n = c(44, 44))
gunderson_and_levine.2011_tib 
```

```{r boonen_et_al.2011}
boonen_et_al.2011_tib <- c(
  "boonen_et_al.2011a", 
  "boonen_et_al.2011b", 
  "boonen_et_al.2011c", 
  "boonen_et_al.2011d", 
  "boonen_et_al.2011e", 
  "boonen_et_al.2011f", 
  "boonen_et_al.2011g", 
  "boonen_et_al.2011h") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Calculation NT predicting MA", "Conventional Nominatives NT predicting MA", "Conventional Nominatives predicting ENT-R Verbal Subtest", "Counting NT predicting ENT-R Verbal Counting Subtest", "Ordering NT predicting ENT-R Verbal Counting Subtest", "Number Symbols NT predicting ENT-R Verbal Counting Subtest", "Cardinality NT predicting quantity comparison task", "Calculation NT predicting Cardinality"),
      year = c(2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011),
      country = c("NE", "NE", "NE", "NE", "NE", "NE", "NE", "NE"),
      study_id = c("b", "b", "b", "b", "b", "b", "b", "b"),
      design = c("Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational"),
      design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational"), 
      SES = c("Middle", "Middle", "Middle", "Middle", "Middle", "Middle", "Middle", "Middle"),
      main_language = c("Dutch", "Dutch", "Dutch", "Dutch", "Dutch", "Dutch", "Dutch", "Dutch"),
      deliverer_type = c("Teacher", "Teacher", "Teacher", "Teacher", "Teacher", "Teacher", "Teacher", "Teacher"),
      mothers = c(NA, NA, NA, NA, NA, NA, NA, NA),
      white = c(NA, NA, NA, NA, NA, NA, NA, NA), 
      female = c(0.501992032, 0.501992032, 0.501992032, 0.501992032, 0.501992032, 0.501992032, 0.501992032, 0.501992032),
      child_age_study_start = c(1899.3, 1899.3, 1899.3, 1899.3, 1899.3, 1899.3, 1899.3, 1899.3),
      child_age_NT_start = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_NT_mid = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_NT_end = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_MA = c(NA, NA, NA, NA, NA, NA, NA, NA),
      NT_measure_time = c(60, 60, 60, 60, 60, 60, 60, 60),
      time_between_NT_mid_MA = c(NA, NA, NA, NA, NA, NA, NA, NA),
      intervention_dosage = c(NA, NA, NA, NA, NA, NA, NA, NA),
      NT_context = c("School", "School", "School", "School", "School", "School", "School", "School"),
      MA_context = c("School", "School", "School", "School", "School", "School", "School", "School"),
      NT_size = c("Overall", "Overall","Overall","Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_size.1 = c("Overall", "Overall","Overall","Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_size.2 = c("Overall", "Overall","Overall","Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_type = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.1 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.2 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.3 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.4 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.5 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.6 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.7 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.8 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.9 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      NT_type.10 = c("Calculation", "Conventional_Nominatives", "Conventional_Nominatives","Counting", "Ordering", "Number_Symbols", "Cardinality", "Calculation"),
      MA_test = c("AD_Number_Sense", "AD_Number_Sense", "ENT_R_Counting_subtest", "ENT_R_Counting_subtest","ENT_R_Counting_subtest", "ENT_R_Counting_subtest", "Quantity_Comparison_Task", "Number_Naming_Task"),
      MA_measure = c("Overall", "Overall", "Counting", "Counting", "Counting", "Counting", "Magnitude_Comparison", "Cardinality"),
      analysis = c("Multiple_Regression", "Multiple_Regression", "Multiple_Multilevel_Regression", "Multiple_Multilevel_Regression", "Multiple_Multilevel_Regression", "Multiple_Multilevel_Regression", "Multiple_Regression", "Multiple_Regression"),
      controlled_variables = c(5, 2, 7, 7, 7, 7, 2, 3),
      r = c(-0.1394642, 0.1733843, 0.2875227, -0.1124199, -0.1356559, -0.1237494, 0.1187748, -0.1475598),
      n = c(251, 251, 251, 251, 251, 251, 251, 251))
boonen_et_al.2011_tib
```


```{r susperreguy_and_davis_kean.2016}
susperreguy_and_davis_kean.2016_tib <- c(
  "susperreguy_and_davis_kean.2016a") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Proportion of Cumulative Math Talk - TEMA-3"),
      year = c(2016),
      country = c("US"),
      study_id = c("d"),
      design = c("Correlational"),
      design.2 = c("Longitudinal_Correlational"), 
      SES = c("Middle"),
      main_language = c("English"),
      deliverer_type = c("Parent"),
      mothers = c(1),
      white = c(0.686), 
      female = c(0.314285714),
      child_age_study_start = c(1643.625),
      child_age_NT_start = c(1643.625),
      child_age_NT_mid = c(1647.125),
      child_age_NT_end = c(1650.625),
      child_age_MA = c(2008.875),
      NT_measure_time = c(240),
      time_between_NT_mid_MA = c(365.25),
      intervention_dosage = c(NA),
      NT_context = c("Home"),
      MA_context = c(NA),
      NT_size = c("Overall"),
      NT_size.1 = c("Overall"),
      NT_size.2 = c("Overall"),
      NT_type = c("Overall"),
      NT_type.1 = c("Overall"),
      NT_type.2 = c("Overall"),
      NT_type.3 = c("Overall"),
      NT_type.4 = c("Overall"),
      NT_type.5 = c("Overall"),
      NT_type.6 = c("Overall"),
      NT_type.7 = c("Overall"),
      NT_type.8 = c("Overall"),
      NT_type.9 = c("Overall"),
      NT_type.10 = c("Overall"),
      MA_test = c("TEMA_3"),
      MA_measure = c("Overall"),
      analysis = c("Zero_Order_Correlation"),
      controlled_variables = c(0),
      r = c(0.17),
      n = c(33))
susperreguy_and_davis_kean.2016_tib
```

```{r casey_et_al.2018}
casey_et_al.2018_tib <- c(
  "casey_et_al.2018a", 
  "casey_et_al.2018b",
  "casey_et_al.2018c", 
  "casey_et_al.2018d", 
  "casey_et_al.2018e", 
  "casey_et_al.2018f", 
  "casey_et_al.2018g", 
  "casey_et_al.2018h") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Identify numerals NT - WJ Applied Problems at 4.5 yrs", "Identify numerals NT - WJ Applied Problems at 1st grade", "One-to-one counting NT - WJ Applied Problems at 4.5 yrs", "One-to-one counting NT - WJ Applied Problems at 1st grade", "Label sets NT - WJ Applied Problems at 4.5 yrs", "Label sets NT - WJ Applied Problems at 1st grade", "Sum of numerical supports NT - WJ Applied Problems at 4.5 yrs", "Sum of numerical supports NT - WJ Applied Problems at 1st grade"),
      year = c(2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018),
      country = c("US", "US", "US", "US", "US", "US", "US", "US"),
      study_id = c("f", "f", "f", "f", "f", "f", "f", "f"),
      design = c("Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational", "Correlational"),
      design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational", "Longitudinal_Correlational"), 
      SES = c("Middle", "Middle", "Middle", "Middle", "Middle", "Middle", "Middle", "Middle"),
      main_language = c("English", "English", "English", "English", "English", "English", "English", "English"),
      deliverer_type = c("Parent", "Parent", "Parent", "Parent", "Parent", "Parent", "Parent", "Parent"),
      mothers = c(1, 1, 1, 1, 1, 1, 1, 1),
      white = c(0.84, 0.84, 0.84, 0.84, 0.84, 0.84, 0.84, 0.84), 
      female = c(0.45, 0.45, 0.45, 0.45, 0.45, 0.45, 0.45, 0.45),
      child_age_study_start = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_NT_start = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_NT_mid = c(1095.75, 1095.75, 1095.75, 1095.75, 1095.75, 1095.75, 1095.75, 1095.75),
      child_age_NT_end = c(NA, NA, NA, NA, NA, NA, NA, NA),
      child_age_MA = c(1643.625, 2374.125, 1643.625, 2374.125, 1643.625, 2374.125, 1643.625, 2374.125),
      NT_measure_time = c(10, 10, 10, 10, 10, 10, 10, 10),
      time_between_NT_mid_MA = c(547.875, 1278.375, 547.875, 1278.375, 547.875, 1278.375, 547.875, 1278.375),
      intervention_dosage = c(NA, NA, NA, NA, NA, NA, NA, NA),
      NT_context = c("Lab", "Lab", "Lab", "Lab", "Lab", "Lab", "Lab", "Lab"),
      MA_context = c(NA, NA, NA, NA, NA, NA, NA, NA),
      NT_size = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_size.1 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_size.2 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_type = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.1 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.2 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.3 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.4 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.5 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.6 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.7 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.8 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.9 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      NT_type.10 = c("Number_Identification", "Number_Identification", "Counting", "Counting", "Labelling", "Labelling", "Overall", "Overall"),
      MA_test = c("WJ_AP", "WJ_AP", "WJ_AP", "WJ_AP", "WJ_AP", "WJ_AP", "WJ_AP", "WJ_AP"),
      MA_measure = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      analysis = c("Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation","Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation", "Zero_Order_Correlation"),
      controlled_variables = c(0, 0, 0, 0, 0, 0, 0, 0),
      r = c(-0.02, -0.04, -0.01, 0.05, 0.30, 0.33, 0.06, 0.07),
      n = c(99, 99, 99, 99, 99, 99, 99, 99))
casey_et_al.2018_tib
```

```{r zippert_et_al.2019}
zippert_et_al.2019_tib <- c(
  "zippert_et_al.2019a", 
  "zippert_et_al.2019b", 
  "zippert_et_al.2019c", 
  "zippert_et_al.2019d",
  "zippert_et_al.2019e",
  "zippert_et_al.2019f",
  "zippert_et_al.2019g",
  "zippert_et_al.2019h") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Counting NT - Rote Counting", "Number Identification NT - Rote Counting", "Cardinality NT - Rote Counting", "Magnitude Comparison NT - Rote Counting", "Counting NT - Number Line Estimation", "Number Identification NT - Number Line Estimation", "Cardinality NT - Number Line Estimation", "Magnitude Comparison NT - Number Line Estimation"),
      year = c(2019, 2019, 2019, 2019, 2019, 2019, 2019, 2019),
      country = c("US", "US", "US", "US", "US", "US", "US", "US"),
      study_id = c("h", "h", "h", "h", "h", "h", "h", "h"),
      design = c("Experimental", "Experimental", "Experimental", "Experimental", "Experimental", "Experimental", "Experimental", "Experimental"),
      design.2 = c("Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental", "Short_term_Experimental"), 
      SES = c(NA, NA, NA, NA, NA, NA, NA, NA),
      main_language = c("English", "English", "English", "English", "English", "English", "English", "English"),
      deliverer_type = c("Parent", "Parent", "Parent", "Parent", "Parent", "Parent", "Parent", "Parent"),
      mothers = c(0.61, 0.61, 0.61, 0.61, 0.61, 0.61, 0.61, 0.61),
      white = c(NA, NA, NA, NA, NA, NA, NA, NA), 
      female = c(0.41, 0.41, 0.41, 0.41, 0.41, 0.41, 0.41, 0.41),
      child_age_study_start = c(1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99),
      child_age_NT_start = c(1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99),
      child_age_NT_mid = c(1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99),
      child_age_NT_end = c(1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99),
      child_age_MA = c(1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99, 1835.99),
      NT_measure_time = c(NA, NA, NA, NA, NA, NA, NA, NA),
      time_between_NT_mid_MA = c(0, 0, 0, 0, 0, 0, 0, 0),
      intervention_dosage = c(0.006944444, 0.006944444, 0.006944444, 0.006944444, 0.006944444, 0.006944444, 0.006944444, 0.006944444),
      NT_context = c("Museum", "Museum", "Museum", "Museum", "Museum", "Museum", "Museum", "Museum"),
      MA_context = c("Museum", "Museum", "Museum", "Museum", "Museum", "Museum", "Museum", "Museum"),
      NT_size = c(NA, NA, NA, NA, NA, NA, NA, NA),
      NT_size.1 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_size.2 = c("Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall", "Overall"),
      NT_type = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.1 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.2 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.3 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.4 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.5 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.6 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.7 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.8 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.9 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      NT_type.10 = c("Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison", "Counting", "Number_Identification", "Cardinality", "Magnitude_Comparison"),
      MA_test = c("Verbal_Counting", "Verbal_Counting", "Verbal_Counting", "Verbal_Counting", "Number_Line_Estimation", "Number_Line_Estimation", "Number_Line_Estimation", "Number_Line_Estimation"),
      MA_measure = c("Counting", "Counting", "Counting", "Counting", "Number_Line_Estimation", "Number_Line_Estimation", "Number_Line_Estimation", "Number_Line_Estimation"),
      analysis = c("Partial_Correlation", "Partial_Correlation", "Partial_Correlation", "Partial_Correlation", "Partial_Correlation", "Partial_Correlation", "Partial_Correlation", "Partial_Correlation"),
      controlled_variables = c(2, 2, 2, 2, 2, 2, 2, 2),
      r = c(-0.40, -0.03, 0.095, -0.065, 0.085, -0.01, -0.135, -0.01),
      n = c(51, 51, 51, 51, 51, 51, 51, 51))
zippert_et_al.2019_tib


```

```{r thippana_et_al.2020}
thippana_et_al.2020_tib <- c(
  "thippana_et_al.2020a", 
  "thippana_et_al.2020b") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Home NT proportion - TEMA-3 ", "Lab NT proportion - TEMA-3"),
      year = c(2020, 2020),
      country = c(NA, NA),
      study_id = c("j", "j"),
      design = c("Correlational", "Correlational"),
      design.2 = c("Longitudinal_Correlational", "Longitudinal_Correlational"), 
      SES = c("Middle",  "Middle"),
      main_language = c("English", "English"),
      deliverer_type = c("Parent", "Parent"),
      mothers = c(0.94, 0.94),
      white = c(0.85, 0.85), 
      female = c(0.484536082, 0.484536082),
      child_age_study_start = c(1430.562, 1430.562),
      child_age_NT_start = c(NA, NA),
      child_age_NT_mid = c(1446.172, 1446.172),
      child_age_NT_end = c(NA, NA),
      child_age_MA = c(1492.442, 1492.442),
      NT_measure_time = c(30, 20),
      time_between_NT_mid_MA = c(46.27, 46.27),
      intervention_dosage = c(NA, NA),
      NT_context = c("Home", "Lab"),
      MA_context = c("Lab", "Lab"),
      NT_size = c(NA, NA),
      NT_size.1 = c("Overall", "Overall"),
      NT_size.2 = c("Overall", "Overall"),
      NT_type = c("Overall", "Overall"),
      NT_type.1 = c("Overall", "Overall"),
      NT_type.2 = c("Overall", "Overall"),
      NT_type.3 = c("Overall", "Overall"),
      NT_type.4 = c("Overall", "Overall"),
      NT_type.5 = c("Overall", "Overall"),
      NT_type.6 = c("Overall", "Overall"),
      NT_type.7 = c("Overall", "Overall"),
      NT_type.8 = c("Overall", "Overall"),
      NT_type.9 = c("Overall", "Overall"),
      NT_type.10 = c("Overall", "Overall"),
      MA_test = c("TEMA_3", "TEMA_3"),
      MA_measure = c("Overall", "Overall"),
      analysis = c("Zero_Order_Correlation", "Zero_Order_Correlation"),
      controlled_variables = c(0, 0),
      r = c(0.20, 0.11),
      n = c(81, 81))
thippana_et_al.2020_tib
```

```{r gibson_et_al.2020}
gibson_et_al.2020_tib <- c(
  "gibson_et_al.2020a", 
  "gibson_et_al.2020b") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("Small Number Book vs Control", "Large Number vs Control"),
      year = c(2020, 2020),
      country = c("US", "US"),
      study_id = c("k", "k"),
      design = c("Experimental", "Experimental"),
      design.2 = c("Long_term_Experimental", "Long_term_Experimental"), 
      SES = c("Middle", "Middle"),
      main_language = c("English", "English"),
      deliverer_type = c("Parent", "Parent"),
      mothers = c(NA, NA),
      white = c(0.52, 0.52), 
      female = c(0.52, 0.52),
      child_age_study_start = c(1132.275, 1132.275),
      child_age_NT_start = c(1132.275, 1132.275),
      child_age_NT_mid = c(1148.77, 1148.77),
      child_age_NT_end = c(1165.265, 1165.265),
      child_age_MA = c(1165.265, 1165.265),
      NT_measure_time = c(NA, NA),
      time_between_NT_mid_MA = c(16.495, 16.495),
      intervention_dosage = c(32.99, 32.99),
      NT_context = c("Home", "Home"),
      MA_context = c("Lab", "Lab"),
      NT_size = c("Small", "Large"),
      NT_size.1 = c("Small", "Large"),
      NT_size.2 = c("Small", "Large"),
      NT_type = c("Counting_and_Labelling", "Counting_and_Labelling"),
      NT_type.1 = c("Overall", "Overall"),
      NT_type.2 = c("Counting", "Counting"),
      NT_type.3 = c("Counting", "Counting"),
      NT_type.4 = c("Labelling", "Labelling"),
      NT_type.5 = c("Counting", "Counting"),
      NT_type.6 = c("Labelling", "Labelling"),
      NT_type.7 = c("Labelling", "Labelling"),
      NT_type.8 = c("Labelling", "Labelling"),
      NT_type.9 = c("Counting", "Counting"),
      NT_type.10 = c(NA, NA),
      MA_test = c("Give_N", "Give_N"),
      MA_measure = c("Number_Knowledge", "Number_Knowledge"),
      analysis = c("Pairwise_t", "Pairwise_t"),
      controlled_variables = c(0, 0),
      r = c(0.3224328, 0.069597355),
      n = c(97, 97))
gibson_et_al.2020_tib
```

```{r silver_et_al.2021}
silver_et_al.2021_tib <- c(
  "silver_et_al.2021a") %>% 
  data.frame() %>% rename(., effect = .) %>% 
    add_column(
      effect_description = c("NT - MA"),
      year = c(2021),
      country = c("US"),
      study_id = c("l"),
      design = c("Correlational"),
      design.2 = c("Cross_sectional_Correlational"), 
      SES = c("Middle"),
      main_language = c("English"),
      deliverer_type = c("Parent"),
      mothers = c(0.95),
      white = c(0.8), 
      female = c(0.479674797),
      child_age_study_start = c(1430.562),
      child_age_NT_start = c(1430.562),
      child_age_NT_mid = c(1430.562),
      child_age_NT_end = c(1430.562),
      child_age_MA = c(1430.562),
      NT_measure_time = c(10),
      time_between_NT_mid_MA = c(0),
      intervention_dosage = c(NA),
      NT_context = c("Lab"),
      MA_context = c("Lab"),
      NT_size = c("Overall"),
      NT_size.1 = c("Overall"),
      NT_size.2 = c("Overall"),
      NT_type = c("Overall"),
      NT_type.1 = c("Overall"),
      NT_type.2 = c("Overall"),
      NT_type.3 = c("Overall"),
      NT_type.4 = c("Overall"),
      NT_type.5 = c("Overall"),
      NT_type.6 = c("Overall"),
      NT_type.7 = c("Overall"),
      NT_type.8 = c("Overall"),
      NT_type.9 = c("Overall"),
      NT_type.10 = c("Overall"),
      MA_test = c("TEMA_3"),
      MA_measure = c("Overall"),
      analysis = c("Zero_Order_Correlation"),
      controlled_variables = c(0),
      r = c(0.04),
      n = c(123))
silver_et_al.2021_tib


#lower_ci <- fz-(((qnorm(p = ((1-(1-cl)/2)), mean = 0, sd = 1)))*(se_fz))
#qnorm(p = ((1-(1-cl)/2)))
#1-((1-0.95)/2)
#1-pt(q = 1.886838378, df = 113)
#qt(p = 0.975, df = 113)
#qnorm(p = 0.975)
#-(-0.01 - 0.10)/qt(p = 0.975, df = 121)
#(0.20 - 0.10)/qt(p = 0.975, df = 121)
#((0.20 - 0.10)/qt(p = 0.975, df = 121) + (-(-0.01 - 0.10)/qt(p = 0.975, df = 121)))/2
#-(-0.16 - (-0.06))/qt(p = 0.975, df = 121)
#(0.03 -(-0.06))/qt(p = 0.975, df = 121)
#((-(-0.16 - (-0.06))/qt(p = 0.975, df = 121))+((0.03 -(-0.06))/qt(p = 0.975, df = 121)))/2
#qt(p = (1-0.038), df = 121)
#0.10/qt(p = (1-0.038), df = 121)
#qt(p = (1-0.0815), df = 121)
#-(-0.06/qt(p = (1-0.0815), df = 121))
#0.1 - (1.979764 * 0.05051108)
#sqrt((1.2503772 ^2)/((1.2503772^2)+121))

```

```{r meta_analysis}
meta_tib.p1 <- rbind(
  levine_et_al.2010_tib, 
  boonen_et_al.2011_tib,
  ramani_et_al.2015_tib,
  susperreguy_and_davis_kean.2016_tib,
  elliott_et_al.2017_tib, 
  casey_et_al.2018_tib,
  mutaf_yildiz_et_al.2018_tib, 
  zippert_et_al.2019_tib,
  son_and_hur.2020_tib,
  thippana_et_al.2020_tib, 
  gibson_et_al.2020_tib, 
  silver_et_al.2021_tib) 
meta_tib.p1 %>% view()

#write.xlsx(meta_tib, "meta_tib.xlsx", overwrite = F)
meta_tib <- escalc(measure = "ZCOR", ri = r, ni = n, data = meta_tib.p1) %>% data.frame() %>% 
    mutate(
    effect_description = as.character(effect_description),
    year = as.numeric(year),
    country = as.factor(country),
    study_id = as.factor(study_id),
    design = as.factor(design),
    design.2 = as.factor(design.2),
    SES = as.factor(SES),
    main_language = as.factor(main_language),
    deliverer_type = as.factor(deliverer_type),
    mothers = as.numeric(mothers),
    white = as.numeric(white),
    female = as.numeric(female),
    child_age_study_start = as.numeric(child_age_study_start),
    child_age_NT_start = as.numeric(child_age_NT_start),
    child_age_NT_mid = as.numeric(child_age_NT_mid),
    child_age_NT_end = as.numeric(child_age_NT_end),
    child_age_MA = as.numeric(child_age_MA),
    NT_measure_time = as.numeric(NT_measure_time),
    time_between_NT_mid_MA = as.numeric(time_between_NT_mid_MA),
    intervention_dosage = as.numeric(intervention_dosage),
    NT_context = as.factor(NT_context),
    MA_context = as.factor(MA_context),
    NT_size = as.factor(NT_size),
    NT_size.1 = as.factor(NT_size.1),
    NT_size.2= as.factor(NT_size.2),
    NT_type = as.factor(NT_type),
    NT_type.1 = as.factor(NT_type.1),
    NT_type.2 = as.factor(NT_type.2),
    NT_type.3 = as.factor(NT_type.3),
    NT_type.4 = as.factor(NT_type.4),
    NT_type.5 = as.factor(NT_type.5),
    NT_type.6 = as.factor(NT_type.6),
    NT_type.7 = as.factor(NT_type.7),
    NT_type.8 = as.factor(NT_type.8),
    NT_type.9 = as.factor(NT_type.9),
    NT_type.10 = as.factor(NT_type.10),
    MA_test = as.factor(MA_test),
    MA_measure = as.factor(MA_measure),
    analysis = as.factor(analysis),
    controlled_variables = as.numeric(controlled_variables),
    r = as.numeric(r),
    n = as.numeric(n)) %>% 
  dplyr::mutate(
    main_language = forcats::fct_relevel(main_language, "Dutch", "English"),
    NT_type.2 = forcats::fct_relevel(NT_type.2, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.3 = forcats::fct_relevel(NT_type.3, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.4 = forcats::fct_relevel(NT_type.4, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.5 = forcats::fct_relevel(NT_type.5, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.6 = forcats::fct_relevel(NT_type.6, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.7 = forcats::fct_relevel(NT_type.7, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.8 = forcats::fct_relevel(NT_type.8, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.9 = forcats::fct_relevel(NT_type.9, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    NT_type.10 = forcats::fct_relevel(NT_type.10, "Calculation", "Cardinality", "Conventional_Nominatives", "Counting", "Labelling", "Magnitude_Comparison", "Number_Identification", "Number_Symbols", "Ordering", "Overall"),
    MA_context = forcats::fct_relevel(MA_context, "Home", "Lab", "School", "Museum"),
    MA_measure = forcats::fct_relevel(MA_measure, "Calculation", "Cardinality", "Counting", "Magnitude_Comparison", "Number_Identification", "Number_Knowledge", "Number_Line_Estimation", "Overall"),
    NT_context = forcats::fct_relevel(NT_context, "Home", "Lab", "School", "Museum"))
  #dplyr::select(-NT_type.2, -NT_type.3,-NT_type.4,-NT_type.5,-NT_type.6,-NT_type.7,-NT_type.8, -NT_type.9, -NT_type.10, -NT_size.1, - NT_size.2)



levels(meta_tib$NT_type.2)
levels(meta_tib$NT_type.3)
levels(meta_tib$NT_type.4)
levels(meta_tib$NT_type.5)
levels(meta_tib$NT_type.6)
levels(meta_tib$NT_type.7)
levels(meta_tib$NT_type.8)
levels(meta_tib$NT_type.9)
levels(meta_tib$NT_type.10)
levels(meta_tib$MA_measure)
levels(meta_tib$NT_context)
meta_tib %>% view()



#rma(yi = ri, vi = vi, data = meta_tib, method  = "DL", data = meta_data)

#Meta-analysis
#meta_model <- rma(yi = yi, vi = vi, data = meta_tib.escalc, method  = "DL")
#meta_model
#DL - 0.1407, 0.1314
#HE - 0.1406, 0.1278
#HSk - 0.1407, 0.1309
#HS - 0.1406, 0.1283
#ML - 0.1406, 0.1302
#REML - 0.1407, 0.1331
#SJ - 0.1414, 0.1614
#EB - 0.1407, 0.1319
#PM - 0.1407, 0.1319
#In the Forest 
#forest(meta_model, addpred = T, header = T)

#It's a pyramid
#funnel(meta_model)

#Predicting the future
#predict(meta_model, transf = transf.ztor, digits = 5)

#Gosh Plot 
#plot(gosh(meta_model, subset = 2000), out = 10)

meta_tib
```


```{r ml_meta_analysis}
ml_meta_model <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t", 
                        random = ~ 1 | study_id/effect)
ml_meta_model 

rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "ML", test = "t", 
                        random = ~ 1 | study_id/effect)

#ML 
#---Estimate = 0.0852 (P = 0.0401)
#--- Between-study variance = 0.0106 
#--- Within-study variance = 0.0119

#REML 
#---Estimate = 0.0871 (P = 0.0484)
#--- Between-study variance = 0.0130 
#--- Within-study variance = 0.0118



#Bubble plot 
#regplot(meta_model, xlab = "x label", xlim = c(-, -), predlim= c(), transf = )
#Significant result 

```

```{r moderator_analysis_main_language}
#Checking the levels 
levels(meta_tib$main_language)
#Setting contrast weights
english_vs_dutch <- c(-1/2, 1/2)
contrasts(meta_tib$main_language) <- english_vs_dutch

#Moderator analysis
ml_meta_model_mod_main_language <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "ML", test = "t",
       mods = ~ main_language,
       random = ~ 1 | study_id/effect)
ml_meta_model_mod_main_language


#Regression Plot
regplot(ml_meta_model_mod_main_language, xlab = "Language")

```

```{r moderator_analysis_NT_type.1}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.1)

#Setting contrast weights 
calculationNT.1_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.1_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.1_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.1_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.1_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.1_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.1_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.1_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.1_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.1) <- cbind(
  calculationNT.1_vs_mean, 
  cardinalityNT.1_vs_mean,            
  conventional_nominativesNT.1_vs_mean, 
  countingNT.1_vs_mean, 
  labellingNT.1_vs_mean,
  magnitude_comparisonNT.1_vs_mean,  
  number_identificationNT.1_vs_mean, 
  number_symbolsNT.1_vs_mean,        
  orderingNT.1_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.1 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.1, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.1
#SIGNIFICANT RESULTS
#INTERCEPT = 	0.0252==
#NT that have significantly greater effect 
#---Conventional_Nominatives (0.3187)==
#---Labelling (0.5836)==
#NT that have significantly smaller effect 
#---Calculation NT (-0.3124)==
#---Counting NT (-0.1833)==
#---Ordering NT (-0.3046)==
#---Number Symbols (-0.2804)==

```


```{r moderator_analysis_NT_type.2}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.2)

#Setting contrast weights 
calculationNT.2_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.2_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.2_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.2_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.2_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.2_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.2_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.2_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.2_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.2) <- cbind(
  calculationNT.2_vs_mean, 
  cardinalityNT.2_vs_mean,            
  conventional_nominativesNT.2_vs_mean, 
  countingNT.2_vs_mean, 
  labellingNT.2_vs_mean,
  magnitude_comparisonNT.2_vs_mean,  
  number_identificationNT.2_vs_mean, 
  number_symbolsNT.2_vs_mean,        
  orderingNT.2_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.2 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.2, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.2
#SIGNIFICANT RESULTS
#INTERCEPT = 0.0796==
#NT that have significantly greater effect 
#---Cardinality (0.2037)==
#---Conventional_Nominatives (0.3395)==
#---Labelling (0.5339)==
#NT that have significantly smaller effect 
#---Calculation NT (-0.2915)==
#---Counting NT (-0.1761)==
#---Ordering NT (-0.2838)==

```

```{r moderator_analysis_NT_type.3}
levels(meta_tib$NT_type.3)

#Setting contrast weights 
calculationNT.3_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.3_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.3_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.3_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.3_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.3_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.3_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.3_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.3_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.3) <- cbind(
  calculationNT.3_vs_mean, 
  cardinalityNT.3_vs_mean,            
  conventional_nominativesNT.3_vs_mean, 
  countingNT.3_vs_mean, 
  labellingNT.3_vs_mean,
  magnitude_comparisonNT.3_vs_mean,  
  number_identificationNT.3_vs_mean, 
  number_symbolsNT.3_vs_mean,        
  orderingNT.3_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.3 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.3, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.3
#SIGNIFICANT RESULTS
#INTERCEPT = 	0.1092
#NT that have significantly greater effect 
#---Conventional Nominatives (0.3947)==
#---Labelling(0.4618)==
#NT that have significantly smaller effect 
#--- Number Identification (-0.2747)=
##DIFFERENT LUMPING DID NOT AFFECT THE RESULT
```


```{r}
levels(meta_tib$NT_type.4)

#Setting contrast weights 
calculationNT.4_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.4_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.4_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.4_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.4_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.4_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.4_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.4_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.4_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.4) <- cbind(
  calculationNT.4_vs_mean, 
  cardinalityNT.4_vs_mean,            
  conventional_nominativesNT.4_vs_mean, 
  countingNT.4_vs_mean, 
  labellingNT.4_vs_mean,
  magnitude_comparisonNT.4_vs_mean,  
  number_identificationNT.4_vs_mean, 
  number_symbolsNT.4_vs_mean,        
  orderingNT.4_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.4 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.4, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.4
#SIGNIFICANT RESULTS
#NT that have significantly greater effect 
#---Conventional_Nominatives (0.3872)==
#---Labelling (0.4277)==
#NT that have significantly smaller effect 
#---Counting NT (-0.1953)==
#---Number Identification NT (-0.2548)==
##DIFFERENT LUMPING DID NOT AFFECT THE RESULT
```

```{r moderator_analysis_NT_type.5}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.5)

#Setting contrast weights 
calculationNT.5_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.5_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.5_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.5_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.5_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.5_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.5_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.5_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.5_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.5) <- cbind(
  calculationNT.5_vs_mean, 
  cardinalityNT.5_vs_mean,            
  conventional_nominativesNT.5_vs_mean, 
  countingNT.5_vs_mean, 
  labellingNT.5_vs_mean,
  magnitude_comparisonNT.5_vs_mean,  
  number_identificationNT.5_vs_mean, 
  number_symbolsNT.5_vs_mean,        
  orderingNT.5_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.5 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.5, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.5
#SIGNIFICANT RESULTS
#INTERCEPT = 0.1094==
#NT that have significantly greater effect 
#---Conventional_Nominatives (0.3697)==
#---Labelling (0.4815)==
#NT that have significantly smaller effect 
#---Counting NT (-0.2294)==
```


```{r moderator_analysis_NT_type.6}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.6)

#Setting contrast weights 
calculationNT.6_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.6_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.6_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.6_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.6_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.6_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.6_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.6_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.6_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.6) <- cbind(
  calculationNT.6_vs_mean, 
  cardinalityNT.6_vs_mean,            
  conventional_nominativesNT.6_vs_mean, 
  countingNT.6_vs_mean, 
  labellingNT.6_vs_mean,
  magnitude_comparisonNT.6_vs_mean,  
  number_identificationNT.6_vs_mean, 
  number_symbolsNT.6_vs_mean,        
  orderingNT.6_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.6 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.6, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.6
#SIGNIFICANT RESULTS
#INTERCEPT = 	0.0572==
#NT that have significantly greater effect 
#---Conventional_Nominatives (0.3650)==
#---Labelling (0.4430)==
#NT that have significantly smaller effect 
#---Counting NT (-0.2458)==
```


```{r moderator_analysis_NT_type.7}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.7)

#Setting contrast weights 
calculationNT.7_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.7_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.7_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.7_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.7_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.7_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.7_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.7_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.7_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.7) <- cbind(
  calculationNT.7_vs_mean, 
  cardinalityNT.7_vs_mean,            
  conventional_nominativesNT.7_vs_mean, 
  countingNT.7_vs_mean, 
  labellingNT.7_vs_mean,
  magnitude_comparisonNT.7_vs_mean,  
  number_identificationNT.7_vs_mean, 
  number_symbolsNT.7_vs_mean,        
  orderingNT.7_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.7 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.7, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.7
#SIGNIFICANT RESULTS
#INTERCEPT = 0.0207==
#NT that have significantly greater effect 
#--- Cardinality (0.2180)==
#---Conventional_Nominatives (0.3448)==
#---Labelling (0.4858)==
#NT that have significantly smaller effect 
#---Counting NT (-0.1821)==
#--- Calculation NT (-0.2863)==
#--- Ordering (-0.2785)==
```

```{r moderator_analysis_NT_type.8}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.8)

#Setting contrast weights 
calculationNT.8_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.8_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.8_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.8_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.8_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.8_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.8_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.8_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.8_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.8) <- cbind(
  calculationNT.8_vs_mean, 
  cardinalityNT.8_vs_mean,            
  conventional_nominativesNT.8_vs_mean, 
  countingNT.8_vs_mean, 
  labellingNT.8_vs_mean,
  magnitude_comparisonNT.8_vs_mean,  
  number_identificationNT.8_vs_mean, 
  number_symbolsNT.8_vs_mean,        
  orderingNT.8_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.8 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.8, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.8
#SIGNIFICANT RESULTS
#INTERCEPT = 	0.0226==
#NT that have significantly greater effect 
#--- Cardinality (0.2084)==
#---Conventional_Nominatives (0.3374)==
#---Labelling (0.4892)==
#NT that have significantly smaller effect 
#---Counting NT (-0.1935)==
#--- Calculation NT (-0.2936)==
#--- Ordering (-0.2859)==
```

```{r moderator_analysis_NT_type.9}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.9)

#Setting contrast weights 
calculationNT.9_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.9_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.9_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.9_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.9_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.9_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.9_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.9_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.9_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.9) <- cbind(
  calculationNT.9_vs_mean, 
  cardinalityNT.9_vs_mean,            
  conventional_nominativesNT.9_vs_mean, 
  countingNT.9_vs_mean, 
  labellingNT.9_vs_mean,
  magnitude_comparisonNT.9_vs_mean,  
  number_identificationNT.9_vs_mean, 
  number_symbolsNT.9_vs_mean,        
  orderingNT.9_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.9 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.9, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.9
#SIGNIFICANT RESULTS
#INTERCEPT = 	0.0790==
#NT that have significantly greater effect 
#--- Cardinality (0.2102)==
#---Conventional_Nominatives (0.3529)==
#---Labelling (0.5222)==
#NT that have significantly smaller effect 
#--- Calculation NT (-0.2782)==
#--- Ordering (-0.2704)==
```

```{r moderator_analysis_NT_type.10}
#Checking the levels for NT_type.2
levels(meta_tib$NT_type.10)

#Setting contrast weights 
calculationNT.10_vs_mean <-             c(0.5, 0, 0, 0, 0, 0, 0, 0, 0, -0.5)
cardinalityNT.10_vs_mean <-             c(0, 0.5, 0, 0, 0, 0, 0, 0, 0, -0.5)
conventional_nominativesNT.10_vs_mean <- c(0, 0, 0.5, 0, 0, 0, 0, 0, 0, -0.5)
countingNT.10_vs_mean <-                c(0, 0, 0, 0.5, 0, 0, 0, 0, 0, -0.5)
labellingNT.10_vs_mean <-               c(0, 0, 0, 0, 0.5, 0, 0, 0, 0, -0.5)
magnitude_comparisonNT.10_vs_mean <-    c(0, 0, 0, 0, 0, 0.5, 0, 0, 0, -0.5)
number_identificationNT.10_vs_mean <-   c(0, 0, 0, 0, 0, 0, 0.5, 0, 0, -0.5)
number_symbolsNT.10_vs_mean <-          c(0, 0, 0, 0, 0, 0, 0, 0.5, 0, -0.5)
orderingNT.10_vs_mean <-                c(0, 0, 0, 0, 0, 0, 0, 0, 0.5, -0.5)

contrasts(meta_tib$NT_type.10) <- cbind(
  calculationNT.10_vs_mean, 
  cardinalityNT.10_vs_mean,            
  conventional_nominativesNT.10_vs_mean, 
  countingNT.10_vs_mean, 
  labellingNT.10_vs_mean,
  magnitude_comparisonNT.10_vs_mean,  
  number_identificationNT.10_vs_mean, 
  number_symbolsNT.10_vs_mean,        
  orderingNT.10_vs_mean)

#contrasts(meta_tib$NT_type.2) <- contr.sum(10) - This is for sum coding - The p-values/results are all the same as with my manual coding (which was deviation coding)

ml_meta_model_mod_NT_type.10 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                      mods = ~ NT_type.10, 
                                      random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_type.10
#SIGNIFICANT RESULTS
#INTERCEPT = 0.0334==
#NT that have significantly greater effect 
#---Conventional_Nominatives (0.3235)==
#---Labelling (0.5684)==
#NT that have significantly smaller effect 
#--- Calculation NT (-0.3075)==
#--- Ordering (-0.2998)==
```




```{r MA_context}
#Checking the levels for NT_type.2
levels(meta_tib$MA_context)

#Setting contrast weights 
home_vs_mean <- c(1/2, 0, 0, -1/2)
lab_vs_mean <- c(0, 1/2, 0, -1/2)
school_vs_mean <- c(0, 0, 1/2, -1/2)

contrasts(meta_tib$MA_context) <- cbind(
  home_vs_mean,
  lab_vs_mean,
  school_vs_mean)

#Moderator Analysis
ml_meta_model_mod_MA_context <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                       mods = ~ MA_context, 
                                       random = ~ 1 | study_id/effect)
ml_meta_model_mod_MA_context

#RESULTS 
#Measuring MA in a Lab has a greater effect 


```


```{r moderator_analysis_mothers}
#Multilevel Simple Regression
ml_meta_model_mod_mothers <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                    mods = ~ mothers, 
                                    random = ~ 1 | study_id/effect)
ml_meta_model_mod_mothers
#RESULTS
#The proportion of mothers significantly enhanced the effect NT on MA

#Regression Plot
regplot(ml_meta_model_mod_mothers, xlab = "Proportion of Mothers")
```
White is not related, so I will not use that as a covariate

```{r moderator_analysis_child_age_NT_mid}
#Multilevel Simple Regression
ml_meta_model_mod_child_age_NT_mid.M1 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                             mods = ~ child_age_NT_mid, 
                                             random = ~ 1 | study_id/effect)
ml_meta_model_mod_child_age_NT_mid.M1
#The time between NT measure and MA measure significantly diminished the effect NT on MA
#This shows that NT has a greater effect 

#However, the moderating effect of child age during NT may be confounding by the time between NT and MA measure
#So the time between NT and MA measure will be entered into the model
ml_meta_model_mod_child_age_NT_mid.M2 <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                             mods = ~ time_between_NT_mid_MA + child_age_NT_mid, 
                                             random = ~ 1 | study_id/effect)
ml_meta_model_mod_child_age_NT_mid.M2

#Regression Plot
regplot(ml_meta_model_mod_child_age_NT_mid.M1, xlab = "Child Age During Number Talk (Days)")

time_converter(d = 500)
```

```{r moderator_analysis_controlled_variables}
#Multilevel Simple Regression
ml_meta_model_mod_controlled_variables <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                             mods = ~ controlled_variables, 
                                             random = ~ 1 | study_id/effect)
ml_meta_model_mod_controlled_variables


#Regression Plot
regplot(ml_meta_model_mod_controlled_variables, xlab = "The Number of Controlled Variables in the Effect")
```

```{r NT_context}
#Checking the levels
levels(meta_tib$NT_context)

#Setting contrast weights 
NThome_vs_mean <- c(1/2, 0, 0, -1/2)
NTlab_vs_mean <- c(0, 1/2, 0, -1/2)
NTschool_vs_mean <- c(0, 0, 1/2, -1/2)

contrasts(meta_tib$NT_context) <- cbind(
  NThome_vs_mean,
  NTlab_vs_mean,
  NTschool_vs_mean)

#Moderator Analysis
ml_meta_model_mod_NT_context <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                       mods = ~ NT_context, 
                                       random = ~ 1 | study_id/effect)
ml_meta_model_mod_NT_context


```


```{r moderator_analysis_NT_measure_time}
ml_meta_model_mod_NT_measure_time <- rma.mv(yi = yi, V = vi, data = meta_tib, struct = "CS", method = "REML", test = "t",
                                    mods = ~ NT_measure_time, 
                                    random = ~ 1 | study_id/effect)



#Regression Plot


```





